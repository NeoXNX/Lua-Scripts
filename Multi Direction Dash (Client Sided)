-- Put On  StarterCharacterScripts
local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local DashEvent = ReplicatedStorage:WaitForChild("DashEvents"):WaitForChild("DashEvent")
local cooldown = 0.6
local debounce = false


local function isShiftLocked()
	local camera = workspace.CurrentCamera
	if not camera then return false end
	
	
	return UserInputService.MouseBehavior == Enum.MouseBehavior.LockCenter
end

UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if gameProcessed then return end
	if input.KeyCode == Enum.KeyCode.Q and not debounce then
		debounce = true

		local dir = Vector3.new(0,0,0)
		if UserInputService:IsKeyDown(Enum.KeyCode.W) then dir += Vector3.new(0,0,-1) end
		if UserInputService:IsKeyDown(Enum.KeyCode.S) then dir += Vector3.new(0,0,1) end
		if UserInputService:IsKeyDown(Enum.KeyCode.A) then dir += Vector3.new(-1,0,0) end
		if UserInputService:IsKeyDown(Enum.KeyCode.D) then dir += Vector3.new(1,0,0) end

		local locked = isShiftLocked()
		DashEvent:FireServer(dir, locked)

		task.delay(cooldown, function()
			debounce = false
		end)
	end
end)
